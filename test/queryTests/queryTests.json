[
  {
    "query": "select * from `films`",
    "output": {
      "collection": "films",
      "limit": 100
    }
  },
  {
    "query": "select Title,Description from `films`",
    "output": {
      "collection": "films",
      "limit": 100,
      "projection": {
        "Title" : "$Title",
        "Description":"$Description"
      }
    }
  },
  {
    "query": "select Title as Name,Description from `films`",
    "output": {
      "collection": "films",
      "limit": 100,
      "projection": {
        "Name" : "$Title",
        "Description": "$Description"
      }
    }
  },
  {
    "query": "SELECT * FROM customers WHERE `Address.Country`='Japan' ORDER BY id desc",
    "output": {
      "collection": "customers",
      "limit": 100,
      "query": { "Address.Country": {
        "$eq": "Japan" }},
      "sort": { "id" : -1 }
    }

  },
  {
    "query": "select `Replacement Value` as Value,Description from `films`",
    "output": {
      "collection": "films",
      "limit": 100,
      "projection": {
        "Value" : "$Replacement Value",
        "Description": "$Description"
      }
    }
  },
  {
    "query": "select Title as Name,Description from `films`",
    "output": {
      "collection": "films",
      "limit": 100,
      "projection": {
        "Name" : "$Title",
        "Description":"$Description"
      }
    }
  },
  {
    "query": "select 'Name' as Id,Description from `films`",
    "output": {
      "collection": "films",
      "limit": 100,
      "projection": {
        "Id" : { "$literal": "Name" },
        "Description": "$Description"
      }
    }
  },
  {
    "query": "select cast(abs(`id`) as decimal) as `id` from `customers`",
    "output": {
      "collection": "customers",
      "limit": 100,
      "projection": {
        "id": {
          "$convert": {
            "input": {
              "$abs": "$id"
            },
            "to": "decimal"
          }
        }
      }
    }
  },
  {
    "query": "select id,Title,Rating,abs(id*-1) as absId from `films`",
    "output": {"limit":100,"collection":"films","projection":{"id":"$id","Title":"$Title","Rating":"$Rating","absId":{"$abs":{"$multiply":["$id",-1]}}}}

  },
  {
    "query": "select cast('123' as int) as `id` from `customers`",
    "output": {
      "collection": "customers",
      "limit": 100,
      "projection": {
        "id": {
          "$convert": {
            "input": "123",
            "to": "int"
          }
        }
      }
    }
  },
  {
    "query": "select cast(1+`id` as varchar) as `id` from `customers`",
    "output": {"limit":100,"collection":"customers","projection":{"id":{"$convert":{"input":{"$add":[1,"$id"]},"to":"string"}}}}

  },

  {
    "query": "select sum(`Replacement Cost`,2)  from `films`",
    "error": "Requires as for function:sum"
  },
  {
    "query": "select sum(`Replacement Cost`,2,id) as s from `films`",
    "output": {
      "collection": "films",
      "limit": 100,
      "projection": {
        "s": {
          "$add": [
            "$Replacement Cost",
            {
              "$literal": 2
            },
            "$id"
          ]
        }
      }
    }
  },
  {
    "query": "select sum(`Replacement Cost`,2,id) as s from `films`",
    "output": {
      "collection": "films",
      "limit": 100,
      "projection": {
        "s": {
          "$add": [
            "$Replacement Cost",
            {
              "$literal": 2
            },
            "$id"
          ]
        }
      }
    }
  },
  {
    "query": "select `Address.City` as City ,`First Name` as Name from `customers` where `id`>1 limit 10 offset 5",
    "output": {
      "collection": "customers",
      "limit": 10,
      "skip": 5,
      "projection": {
        "City": "$Address.City",
        "Name": "$First Name"
      },
      "query": {
        "id": { "$gt": 1 }

      }
    }
  },
  {
    "query": "select id,Title,Rating,(select * from Rentals where `Film Title` like '%rin%' and staffId=2) as rentalsArr from `customers`",
    "output": {"limit":100,"collection":"customers","projection":{"id":"$id","Title":"$Title","Rating":"$Rating","rentalsArr":{"$map":{"input":{"$filter":{"input":"$Rentals","cond":{"$and":[{"$and":[{"$regexMatch":{"input":"$$this.Film Title","regex":"rin","options":"i"}},{"$eq":["$$this.staffId",2]}]}]}}},"in":"$$this"}}}}
   },
  {
    "query": "select subtract(convert('1','int'),abs(`Replacement Cost`)) as d,Title from `films`",
    "output": {"limit":100,"collection":"films","projection":{"d":{"$subtract":[{"$convert":{"input":{"$literal":"1"},"to":"int"}},{"$abs":"$Replacement Cost"}]},"Title":"$Title"}}

    },
  {
    "query": "SELECT * FROM customers WHERE `First Name` like '%bc%'",
    "output": {
      "limit": 100,
      "collection": "customers",
      "query": { "First Name": { "$regex": "bc", "$options": "i" } }}
  },
  {
    "query": "SELECT * FROM customers WHERE `First Name` like '%bc%' limit 10 offset 2",
    "output": {
      "limit": 10,
      "skip": 2,
      "collection": "customers",
      "query": { "First Name": { "$regex": "bc", "$options": "i" } }}
  },
  {
    "query": "select id,(case when id=3 then '1' when id=2 then '1' else 0 end) as test from `customers`",
    "output": {"limit":100,"collection":"customers","projection":{
      "id": "$id",
      "test": {
        "$switch": {
          "branches": [
            {
              "case": {
                "$eq": [
                  "$id",
                  3
                ]
              },
              "then": "1"
            },
            {
              "case": {
                "$eq": [
                  "$id",
                  2
                ]
              },
              "then": "1"
            }
          ],
          "default": {
            "$literal": 0
          }
        }
      }
    }}
  },
  {
    "query": "SELECT * FROM customers WHERE `First Name` like '%bc%' limit 10 offset 2",
    "output": {
      "limit": 10,
      "skip": 2,
      "collection": "customers",
      "query": { "First Name": { "$regex": "bc", "$options": "i" } }}
  },
   {
    "query": "select * from `films` where id<90 and (id>10 or id=5)",
    "output": {
      "limit": 100,
      "collection": "films",
      "query": {
        "id": {
          "$lt": 90
        },
        "$or": [
          {
            "id": {
              "$gt": 10
            }
          },
          {
            "id": {
              "$eq": 5
            }
          }
        ]
      }
      }
    },
  {
    "query": "select sum(id) as d from `customers` group by d",
    "error": "Query cannot cross multiple collections, have an aggregate function or contain functions in where clauses"
  },
  {
    "name": "Arithmetic:abs",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$abs": "$Replacement Cost"
        }
      },
      "collection": "films"
    },
    "query": "select abs(`Replacement Cost`) as exprVal from `films`"
  },
  {
    "name": "Arithmetic:ceil",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$ceil": "$Replacement Cost"
        }
      },
      "collection": "films"
    },
    "query": "select ceiling(`Replacement Cost`) as exprVal from `films`"
  },
  {
    "name": "Arithmetic:exp",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$exp": "$Replacement Cost"
        }
      },
      "collection": "films"
    },
    "query": "select exp(`Replacement Cost`) as exprVal from `films`"
  },

  {
    "name": "Arithmetic:trunc",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$trunc": [
            "$Replacement Cost",
            {
              "$literal": 1
            }
          ]
        }
      },
      "collection": "films"
    },
    "query": "select trunc(`Replacement Cost`, 1) as exprVal from `films`"
  },
  {
    "name": "Arithmetic:trunc2",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$trunc": [
            "$Replacement Cost"
          ]
        }
      },
      "collection": "films"
    },
    "query": "select trunc(`Replacement Cost`) as exprVal from `films`"
  },
  {
    "name": "Arithmetic:acos",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$acos": {
            "$literal": 0.45
          }
        }
      },
      "collection": "films"
    },
    "query": "select acos(0.45) as exprVal from `films`"
  },

  {
    "name": "Arithmetic:acosh",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$acosh": "$Replacement Cost"
        }
      },
      "collection": "films"
    },
    "query": "select acosh(`Replacement Cost`) as exprVal from `films`"
  },
  {
    "name": "Arithmetic:acosh2",
    "output": {
      "limit": 100,
      "projection": {
        "exprVal": {
          "$acosh": {
            "$literal": 1.2
          }
        }
      },
      "collection": "films"
    },
    "query": "select acosh(1.2) as exprVal from `films`"
  }
]


