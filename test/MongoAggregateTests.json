[
  {
    "query": "select * from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [

      ]
    }
  },
  {
    "query": "select * from `films` limit 10",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [
        {
          "$limit": 10
        }
      ]
    }
  },
  {
    "query": "select * from `films` limit 10 offset 5",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [
        {
          "$limit": 10
        },
        {
          "$skip": 5
        }
      ]
    }
  },
  {
    "query": "select Title,Rating from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [{"$project":{"Title":1,"Rating":1}}]
    }
  },
  {
    "query": "select abs(`Replacement Cost`) as aggr from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [
        {
          "$project": {
            "aggr": {
              "$abs": "$Replacement Cost"
            }
          }
        }
      ]
    }
  },
  {
    "query": "select `Replacement Cost` + 10 as aggr from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [{"$project":{"aggr":{"$add":["$Replacement Cost",10]}}}]
    }
  },
  {
    "query": "select ceiling(`Replacement Cost`) as aggr from `films`",
    "type": "aggregate",
    "output": {"pipeline":[{"$project":{"aggr":{"$ceil":"$Replacement Cost"}}}],"collections":["films"]}
  },
  {
    "query": "select `Replacement Cost` / 10 / 2 as aggr from `films`",
    "type": "aggregate",
    "output": {"pipeline":[{"$project":{"aggr":{"$divide":[{"$divide":["$Replacement Cost",10]},2]}}}],"collections":["films"]}
  },
  {
    "query": "select `Address.City` as City,avg(arrayLength(`Rentals`)) as AvgRentals from `customers` where `First Name` like 'm%' group by `Address.City`",
    "type": "aggregate",
    "output": {
      "collections": ["customers"],
      "pipeline": [
        {
          "$match": {
            "First Name": {
              "$regex": "^m",
              "$options": "i"
            }
          }
        },
        {
          "$group": {
            "_id": {"City":"$Address.City"},
            "AvgRentals": {
              "$avg": {
                "$size": "$Rentals"
              }
            }
          }
        },
        {
          "$project": {
            "City": "$_id.City",
            "AvgRentals": 1,
            "_id":0
          }
        }
      ]
    }
  },
  {
    "query": "select  `Address.Country` as Country,avg(arrayLength(`Rentals`)) as AvgRentals from `customers` where `First Name` like 'm%' group by `Country`",
    "type": "aggregate",
    "output": {
      "collections": ["customers"],
      "pipeline": [
        {
          "$match": {
            "First Name": {
              "$regex": "^m",
              "$options": "i"
            }
          }
        },
        {
          "$group": {
            "_id": {"City":"$Address.Country"},
            "AvgRentals": {
              "$avg": {
                "$size": "$Rentals"
              }
            }
          }
        },
        {
          "$project": {
            "Country": "$_id.Country",
            "AvgRentals": 1,
            "_id":0
          }
        }
      ]
    }
  },
  {
    "query": "select  `Address.Country` as Country,`Address.City` as City,avg(size(`Rentals`)) as AvgRentals from `customers` where `First Name` like 'm%' group by `Address.Country`,`City`",
    "type": "aggregate",
    "output": {
      "collections": ["customers"],
      "pipeline": [
        {
          "$match": {
            "First Name": {
              "$regex": "^m",
              "$options": "i"
            }
          }
        },
        {
          "$group": {
            "_id": {"Country":"$Address.Country","City":"$Address.City"},
            "AvgRentals": {
              "$avg": {
                "$size": "$Rentals"
              }
            }
          }
        },
        {
          "$project": {
            "Country": "$_id.Country",
            "City": "$_id.City",
            "AvgRentals": 1,
            "_id":0
          }
        }
      ]
    }
  },
  {
    "query": "select `Address.City` as City,avg(size(`Rentals`)) as AvgRentals from `customers` where `First Name` like 'm%' group by `Address.City`",
    "type": "aggregate",
    "output": {
      "collections": [
        "customers"
      ],
      "pipeline": [
        {
          "$match": {
            "First Name": {
              "$regex": "^m",
              "$options": "i"
            }
          }
        },
        {
          "$project": {
            "City": "$Address.City",
            "Rentals": 1
          }
        },
        {
          "$group": {
            "_id": {
              "City": "$City"
            },
            "AvgRentals": {
              "$avg": {
                "$size": "$Rentals"
              }
            }
          }
        },
        {
          "$projection": {
            "City": "$_id.City",
            "AvgRentals": 1,
            "_id": -1
          }
        }
      ]
    }
  },
  {
    "query": "select `First Name`,`Last Name`,unwind(`Rentals`) as Rental from `customers`",
    "type": "aggregate",
    "output": {
      "collections": ["customers"],
      "pipeline": [
        {"$unwind":"$Rentals"},{"$project":{"First Name":1,"Last Name":1,"Rental":"$Rentals"}}
      ]
    }
  }


]
