[
  {
    "query": "select abs(`Replacement Cost`) as aggr from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [
        {
          "$project": {
            "aggr": {
              "$abs": "$age"
            }
          }
        }
      ]
    }
  },
  {
    "query": "select `Replacement Cost` + 10 as aggr from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [
        {
          "$limit": 100
        }
      ]
    }
  },
  {
    "query": "select ceiling(`Replacement Cost`) as aggr from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [
        {
          "$limit": 100
        }
      ]
    }
  },
  {
    "query": "select `Replacement Cost` / 10 / 2 as aggr from `films`",
    "type": "aggregate",
    "output": {
      "collections": ["films"],
      "pipeline": [
        {
          "$limit": 100
        }
      ]
    }
  },
  {
    "query": "select `Address.City` as City,avg(size(`Rentals`)) as AvgRentals from `customers` where `First Name` like 'm%' group by `Address.City`",
    "type": "aggregate",
    "output": {
      "collections": ["customers"],
      "pipeline": [
        {
          "$match": {
            "First Name": {
              "$regex": "^m",
              "$options": "i"
            }
          }
        },
        {
          "$project": {
            "City": "$Address.City",
            "Rentals": 1
          }
        },
        {
          "$group": {
            "_id": {
              "City":"$City"},
            "AvgRentals": {
              "$avg": {
                "$size": "$Rentals"
              }
              }
          }
        },
        {
          "$projection": {
            "City": "$_id.City",
            "AvgRentals": 1,
            "_id":-1
          }
        }
      ]
    }
  },
  {
    "query": "select `Address.City` as City,avg(size(`Rentals`)) as AvgRentals from `customers` where `First Name` like 'm%' group by `Address.City`",
    "type": "aggregate",
    "output": {
      "collections": [
        "customers"
      ],
      "pipeline": [
        {
          "$match": {
            "First Name": {
              "$regex": "^m",
              "$options": "i"
            }
          }
        },
        {
          "$project": {
            "City": "$Address.City",
            "Rentals": 1
          }
        },
        {
          "$group": {
            "_id": {
              "City": "$City"
            },
            "AvgRentals": {
              "$avg": {
                "$size": "$Rentals"
              }
            }
          }
        },
        {
          "$projection": {
            "City": "$_id.City",
            "AvgRentals": 1,
            "_id": -1
          }
        }
      ]
    }
  },
  {
    "query": "select `First Name`,`Last Name`,unwind(`Rentals`) as Rental from `customers`",
    "type": "aggregate",
    "output": {
      "collections": ["customers"],
      "pipeline": [
        {
          "$unwind": "$Rentals"
        },{
          "$project": {
            "First Name":1,
            "Last Name": 1,
            "Rental": "$Rentals"

          }
        }
      ]
    }
  },
  {
    "query": "select `First Name`,`Last Name`,unwind(`Rentals`) from `customers`",
    "type": "aggregate",
    "output": {
      "collections": ["customers"],
      "pipeline": [
        {
          "$unwind": "$Rentals"
        },{
          "$project": {
            "First Name":1,
            "Last Name": 1,
            "Rental": "$Rentals"

          }
        },{
          "$mergeObjects": ["$First Name","$Last Name","$Retnal"]

        }
      ]
    }
  }

]
